# Convolutional Neural Network

## Inference

### Throughput on various batch size

Given a batch size `b`, we feed `b` images, denoted by `X`, into `net` to measture the time `t` to run `net(X)`. Then the throughput is calculated by `b/t`.

```{.python .input  n=1}
from bokeh.plotting import show, output_notebook
output_notebook()

```

```{.json .output n=1}
[
 {
  "data": {
   "text/html": "\n    <div class=\"bk-root\">\n        <a href=\"https://bokeh.pydata.org\" target=\"_blank\" class=\"bk-logo bk-logo-small bk-logo-notebook\"></a>\n        <span id=\"b680fd08-87b1-4b61-866b-94d28633699a\">Loading BokehJS ...</span>\n    </div>"
  },
  "metadata": {},
  "output_type": "display_data"
 },
 {
  "data": {
   "application/javascript": "\n(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  var force = true;\n\n  if (typeof (root._bokeh_onload_callbacks) === \"undefined\" || force === true) {\n    root._bokeh_onload_callbacks = [];\n    root._bokeh_is_loading = undefined;\n  }\n\n  var JS_MIME_TYPE = 'application/javascript';\n  var HTML_MIME_TYPE = 'text/html';\n  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';\n  var CLASS_NAME = 'output_bokeh rendered_html';\n\n  /**\n   * Render data to the DOM node\n   */\n  function render(props, node) {\n    var script = document.createElement(\"script\");\n    node.appendChild(script);\n  }\n\n  /**\n   * Handle when an output is cleared or removed\n   */\n  function handleClearOutput(event, handle) {\n    var cell = handle.cell;\n\n    var id = cell.output_area._bokeh_element_id;\n    var server_id = cell.output_area._bokeh_server_id;\n    // Clean up Bokeh references\n    if (id !== undefined) {\n      Bokeh.index[id].model.document.clear();\n      delete Bokeh.index[id];\n    }\n\n    if (server_id !== undefined) {\n      // Clean up Bokeh references\n      var cmd = \"from bokeh.io.state import curstate; print(curstate().uuid_to_server['\" + server_id + \"'].get_sessions()[0].document.roots[0]._id)\";\n      cell.notebook.kernel.execute(cmd, {\n        iopub: {\n          output: function(msg) {\n            var element_id = msg.content.text.trim();\n            Bokeh.index[element_id].model.document.clear();\n            delete Bokeh.index[element_id];\n          }\n        }\n      });\n      // Destroy server and session\n      var cmd = \"import bokeh.io.notebook as ion; ion.destroy_server('\" + server_id + \"')\";\n      cell.notebook.kernel.execute(cmd);\n    }\n  }\n\n  /**\n   * Handle when a new output is added\n   */\n  function handleAddOutput(event, handle) {\n    var output_area = handle.output_area;\n    var output = handle.output;\n\n    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only\n    if ((output.output_type != \"display_data\") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {\n      return\n    }\n\n    var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n\n    if (output.metadata[EXEC_MIME_TYPE][\"id\"] !== undefined) {\n      toinsert[0].firstChild.textContent = output.data[JS_MIME_TYPE];\n      // store reference to embed id on output_area\n      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n    }\n    if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n      var bk_div = document.createElement(\"div\");\n      bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n      var script_attrs = bk_div.children[0].attributes;\n      for (var i = 0; i < script_attrs.length; i++) {\n        toinsert[0].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);\n      }\n      // store reference to server id on output_area\n      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n    }\n  }\n\n  function register_renderer(events, OutputArea) {\n\n    function append_mime(data, metadata, element) {\n      // create a DOM node to render to\n      var toinsert = this.create_output_subarea(\n        metadata,\n        CLASS_NAME,\n        EXEC_MIME_TYPE\n      );\n      this.keyboard_manager.register_events(toinsert);\n      // Render to node\n      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n      render(props, toinsert[0]);\n      element.append(toinsert);\n      return toinsert\n    }\n\n    /* Handle when an output is cleared or removed */\n    events.on('clear_output.CodeCell', handleClearOutput);\n    events.on('delete.Cell', handleClearOutput);\n\n    /* Handle when a new output is added */\n    events.on('output_added.OutputArea', handleAddOutput);\n\n    /**\n     * Register the mime type and append_mime function with output_area\n     */\n    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n      /* Is output safe? */\n      safe: true,\n      /* Index of renderer in `output_area.display_order` */\n      index: 0\n    });\n  }\n\n  // register the mime type if in Jupyter Notebook environment and previously unregistered\n  if (root.Jupyter !== undefined) {\n    var events = require('base/js/events');\n    var OutputArea = require('notebook/js/outputarea').OutputArea;\n\n    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n      register_renderer(events, OutputArea);\n    }\n  }\n\n  \n  if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  var NB_LOAD_WARNING = {'data': {'text/html':\n     \"<div style='background-color: #fdd'>\\n\"+\n     \"<p>\\n\"+\n     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n     \"</p>\\n\"+\n     \"<ul>\\n\"+\n     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n     \"</ul>\\n\"+\n     \"<code>\\n\"+\n     \"from bokeh.resources import INLINE\\n\"+\n     \"output_notebook(resources=INLINE)\\n\"+\n     \"</code>\\n\"+\n     \"</div>\"}};\n\n  function display_loaded() {\n    var el = document.getElementById(\"b680fd08-87b1-4b61-866b-94d28633699a\");\n    if (el != null) {\n      el.textContent = \"BokehJS is loading...\";\n    }\n    if (root.Bokeh !== undefined) {\n      if (el != null) {\n        el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\";\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(display_loaded, 100)\n    }\n  }\n\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) { callback() });\n    }\n    finally {\n      delete root._bokeh_onload_callbacks\n    }\n    console.info(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(js_urls, callback) {\n    root._bokeh_onload_callbacks.push(callback);\n    if (root._bokeh_is_loading > 0) {\n      console.log(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    }\n    if (js_urls == null || js_urls.length === 0) {\n      run_callbacks();\n      return null;\n    }\n    console.log(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n    root._bokeh_is_loading = js_urls.length;\n    for (var i = 0; i < js_urls.length; i++) {\n      var url = js_urls[i];\n      var s = document.createElement('script');\n      s.src = url;\n      s.async = false;\n      s.onreadystatechange = s.onload = function() {\n        root._bokeh_is_loading--;\n        if (root._bokeh_is_loading === 0) {\n          console.log(\"Bokeh: all BokehJS libraries loaded\");\n          run_callbacks()\n        }\n      };\n      s.onerror = function() {\n        console.warn(\"failed to load library \" + url);\n      };\n      console.log(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.getElementsByTagName(\"head\")[0].appendChild(s);\n    }\n  };var element = document.getElementById(\"b680fd08-87b1-4b61-866b-94d28633699a\");\n  if (element == null) {\n    console.log(\"Bokeh: ERROR: autoload.js configured with elementid 'b680fd08-87b1-4b61-866b-94d28633699a' but no matching script tag was found. \")\n    return false;\n  }\n\n  var js_urls = [\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.13.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.13.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.13.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-gl-0.12.13.min.js\"];\n\n  var inline_js = [\n    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\n    \n    function(Bokeh) {\n      \n    },\n    function(Bokeh) {\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-0.12.13.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.13.min.css\");\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.13.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.13.min.css\");\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.13.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.13.min.css\");\n    }\n  ];\n\n  function run_inline_js() {\n    \n    if ((root.Bokeh !== undefined) || (force === true)) {\n      for (var i = 0; i < inline_js.length; i++) {\n        inline_js[i].call(root, root.Bokeh);\n      }if (force === true) {\n        display_loaded();\n      }} else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    } else if (force !== true) {\n      var cell = $(document.getElementById(\"b680fd08-87b1-4b61-866b-94d28633699a\")).parents('.cell').data().cell;\n      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n    }\n\n  }\n\n  if (root._bokeh_is_loading === 0) {\n    console.log(\"Bokeh: BokehJS loaded, going straight to plotting\");\n    run_inline_js();\n  } else {\n    load_libs(js_urls, function() {\n      console.log(\"Bokeh: BokehJS plotting callback run at\", now());\n      run_inline_js();\n    });\n  }\n}(window));",
   "application/vnd.bokehjs_load.v0+json": "\n(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  var force = true;\n\n  if (typeof (root._bokeh_onload_callbacks) === \"undefined\" || force === true) {\n    root._bokeh_onload_callbacks = [];\n    root._bokeh_is_loading = undefined;\n  }\n\n  \n\n  \n  if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  var NB_LOAD_WARNING = {'data': {'text/html':\n     \"<div style='background-color: #fdd'>\\n\"+\n     \"<p>\\n\"+\n     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n     \"</p>\\n\"+\n     \"<ul>\\n\"+\n     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n     \"</ul>\\n\"+\n     \"<code>\\n\"+\n     \"from bokeh.resources import INLINE\\n\"+\n     \"output_notebook(resources=INLINE)\\n\"+\n     \"</code>\\n\"+\n     \"</div>\"}};\n\n  function display_loaded() {\n    var el = document.getElementById(\"b680fd08-87b1-4b61-866b-94d28633699a\");\n    if (el != null) {\n      el.textContent = \"BokehJS is loading...\";\n    }\n    if (root.Bokeh !== undefined) {\n      if (el != null) {\n        el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\";\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(display_loaded, 100)\n    }\n  }\n\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) { callback() });\n    }\n    finally {\n      delete root._bokeh_onload_callbacks\n    }\n    console.info(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(js_urls, callback) {\n    root._bokeh_onload_callbacks.push(callback);\n    if (root._bokeh_is_loading > 0) {\n      console.log(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    }\n    if (js_urls == null || js_urls.length === 0) {\n      run_callbacks();\n      return null;\n    }\n    console.log(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n    root._bokeh_is_loading = js_urls.length;\n    for (var i = 0; i < js_urls.length; i++) {\n      var url = js_urls[i];\n      var s = document.createElement('script');\n      s.src = url;\n      s.async = false;\n      s.onreadystatechange = s.onload = function() {\n        root._bokeh_is_loading--;\n        if (root._bokeh_is_loading === 0) {\n          console.log(\"Bokeh: all BokehJS libraries loaded\");\n          run_callbacks()\n        }\n      };\n      s.onerror = function() {\n        console.warn(\"failed to load library \" + url);\n      };\n      console.log(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.getElementsByTagName(\"head\")[0].appendChild(s);\n    }\n  };var element = document.getElementById(\"b680fd08-87b1-4b61-866b-94d28633699a\");\n  if (element == null) {\n    console.log(\"Bokeh: ERROR: autoload.js configured with elementid 'b680fd08-87b1-4b61-866b-94d28633699a' but no matching script tag was found. \")\n    return false;\n  }\n\n  var js_urls = [\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.13.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.13.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.13.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-gl-0.12.13.min.js\"];\n\n  var inline_js = [\n    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\n    \n    function(Bokeh) {\n      \n    },\n    function(Bokeh) {\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-0.12.13.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.13.min.css\");\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.13.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.13.min.css\");\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.13.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.13.min.css\");\n    }\n  ];\n\n  function run_inline_js() {\n    \n    if ((root.Bokeh !== undefined) || (force === true)) {\n      for (var i = 0; i < inline_js.length; i++) {\n        inline_js[i].call(root, root.Bokeh);\n      }if (force === true) {\n        display_loaded();\n      }} else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    } else if (force !== true) {\n      var cell = $(document.getElementById(\"b680fd08-87b1-4b61-866b-94d28633699a\")).parents('.cell').data().cell;\n      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n    }\n\n  }\n\n  if (root._bokeh_is_loading === 0) {\n    console.log(\"Bokeh: BokehJS loaded, going straight to plotting\");\n    run_inline_js();\n  } else {\n    load_libs(js_urls, function() {\n      console.log(\"Bokeh: BokehJS plotting callback run at\", now());\n      run_inline_js();\n    });\n  }\n}(window));"
  },
  "metadata": {},
  "output_type": "display_data"
 }
]
```

```{.python .input  n=2}
import json
import pandas as pd
import bokeh as bk
!cat cnn*throughput.json >thr.json
with open('thr.json', 'r') as f:
    thr = pd.DataFrame(json.load(f))
```

```{.python .input  n=3}
thr.model.unique()
```

```{.json .output n=3}
[
 {
  "data": {
   "text/plain": "array(['AlexNet', 'DensetNet-121', 'DensetNet-161', 'DensetNet-169',\n       'DensetNet-201', 'ResNet-v1-101', 'ResNet-v1-152', 'ResNet-v1-18',\n       'ResNet-v1-34', 'ResNet-v1-50', 'ResNet-v2-18', 'ResNet-v2-34',\n       'ResNet-v2-50', 'SqueezeNet-1.0', 'SqueezeNet-1.1', 'VGG-11',\n       'VGG-13', 'VGG-16', 'VGG-19'], dtype=object)"
  },
  "execution_count": 3,
  "metadata": {},
  "output_type": "execute_result"
 }
]
```

```{.python .input  n=4}
from bokeh.plotting import figure
from bokeh.models import ColumnDataSource, HoverTool

def batch_size_vs_throughput(data, color='steelblue'):    
    assert 'batch_size' in data.columns, data.columns
    assert 'throughput' in data.columns, data.columns
    p = figure(plot_width=250, plot_height=250, toolbar_location=None, tools="")
    if 'size' in data.columns:
        size = 'size'
    else:
        size = 10
    source = ColumnDataSource(data=data)
    p.scatter(x='batch_size', y='throughput', size=size, 
              color=color, source=source)
    p.xaxis.axis_label = 'batch size'
    p.yaxis.axis_label = '#examples / sec'

    toolstips = [("Throughput", "@throughput"),
                 ("Batch size", "@batch_size")]
    if 'device_mem' in data.columns:
        toolstips.append(["Device memory", "@device_mem MB"])
    p.add_tools(HoverTool(tooltips=toolstips))

    return p

p = batch_size_vs_throughput(thr[thr.model == 'VGG-11'])
show(p)
```

```{.json .output n=4}
[
 {
  "data": {
   "text/html": "\n<div class=\"bk-root\">\n    <div class=\"bk-plotdiv\" id=\"d6115730-4dc1-4cbd-9141-b3c993a92a57\"></div>\n</div>"
  },
  "metadata": {},
  "output_type": "display_data"
 },
 {
  "data": {
   "application/javascript": "(function(root) {\n  function embed_document(root) {\n    \n  var docs_json = {\"ef49c8a3-de5e-4ecd-bf9d-05cd70c38698\":{\"roots\":{\"references\":[{\"attributes\":{},\"id\":\"9ea3b588-dcfe-4b34-9bde-13cb73e5286b\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"e9265e3e-8624-4c21-bc72-845a178dc9bf\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"ea8ac612-0b9f-4aad-a74a-8726f88bab2a\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"axis_label\":\"batch size\",\"formatter\":{\"id\":\"ea8ac612-0b9f-4aad-a74a-8726f88bab2a\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"d9d32e09-082e-4ba6-97aa-463d4c307c28\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"7aa55ab2-6c5c-4ec2-abc3-123639b68c73\",\"type\":\"BasicTicker\"}},\"id\":\"e54ce1c0-f824-4f1d-aac8-f04e2b973015\",\"type\":\"LinearAxis\"},{\"attributes\":{\"fill_color\":{\"value\":\"steelblue\"},\"line_color\":{\"value\":\"steelblue\"},\"size\":{\"units\":\"screen\",\"value\":10},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"6dcfc765-6902-4ef1-bf2d-7e9870a9f3d9\",\"type\":\"Circle\"},{\"attributes\":{},\"id\":\"7aa55ab2-6c5c-4ec2-abc3-123639b68c73\",\"type\":\"BasicTicker\"},{\"attributes\":{\"plot\":{\"id\":\"d9d32e09-082e-4ba6-97aa-463d4c307c28\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"7aa55ab2-6c5c-4ec2-abc3-123639b68c73\",\"type\":\"BasicTicker\"}},\"id\":\"66670596-e482-4efd-9b01-cea26069ba44\",\"type\":\"Grid\"},{\"attributes\":{\"callback\":null,\"tooltips\":[[\"Throughput\",\"@throughput\"],[\"Batch size\",\"@batch_size\"],[\"Device memory\",\"@device_mem MB\"]]},\"id\":\"050250c2-5546-482a-8a63-d19a61ec6922\",\"type\":\"HoverTool\"},{\"attributes\":{\"axis_label\":\"#examples / sec\",\"formatter\":{\"id\":\"d1c0eb07-e135-4e01-98d7-080c4d595bc3\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"d9d32e09-082e-4ba6-97aa-463d4c307c28\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"715692d1-2bc2-441f-bff5-aa6629249f7d\",\"type\":\"BasicTicker\"}},\"id\":\"e34b28a5-2f9e-4268-a311-da340b75db8c\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"d1c0eb07-e135-4e01-98d7-080c4d595bc3\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"715692d1-2bc2-441f-bff5-aa6629249f7d\",\"type\":\"BasicTicker\"},{\"attributes\":{\"dimension\":1,\"plot\":{\"id\":\"d9d32e09-082e-4ba6-97aa-463d4c307c28\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"715692d1-2bc2-441f-bff5-aa6629249f7d\",\"type\":\"BasicTicker\"}},\"id\":\"65fb7510-8689-43a1-9149-ff75db040ff1\",\"type\":\"Grid\"},{\"attributes\":{\"below\":[{\"id\":\"e54ce1c0-f824-4f1d-aac8-f04e2b973015\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"e34b28a5-2f9e-4268-a311-da340b75db8c\",\"type\":\"LinearAxis\"}],\"plot_height\":250,\"plot_width\":250,\"renderers\":[{\"id\":\"e54ce1c0-f824-4f1d-aac8-f04e2b973015\",\"type\":\"LinearAxis\"},{\"id\":\"66670596-e482-4efd-9b01-cea26069ba44\",\"type\":\"Grid\"},{\"id\":\"e34b28a5-2f9e-4268-a311-da340b75db8c\",\"type\":\"LinearAxis\"},{\"id\":\"65fb7510-8689-43a1-9149-ff75db040ff1\",\"type\":\"Grid\"},{\"id\":\"4da425fa-6b13-49b3-8826-dca31c0a6ba7\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"2b1b0067-949f-492f-a4e7-b49d95efa591\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"89e54caf-bab3-4899-ae92-a0b1bbe43474\",\"type\":\"Toolbar\"},\"toolbar_location\":null,\"x_range\":{\"id\":\"8dbc18bb-63dc-45fc-8461-7fa6bc6a8dab\",\"type\":\"DataRange1d\"},\"x_scale\":{\"id\":\"9ea3b588-dcfe-4b34-9bde-13cb73e5286b\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"849d6afa-66ed-4b28-91e9-1126ac30c54b\",\"type\":\"DataRange1d\"},\"y_scale\":{\"id\":\"e9265e3e-8624-4c21-bc72-845a178dc9bf\",\"type\":\"LinearScale\"}},\"id\":\"d9d32e09-082e-4ba6-97aa-463d4c307c28\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"value\":\"#1f77b4\"},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"value\":\"#1f77b4\"},\"size\":{\"units\":\"screen\",\"value\":10},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"c0174f8d-6f91-4394-be34-b34ebfaf06a9\",\"type\":\"Circle\"},{\"attributes\":{\"callback\":null,\"column_names\":[\"batch_size\",\"device\",\"device_mem\",\"model\",\"throughput\",\"workload\",\"index\"],\"data\":{\"batch_size\":[1,2,4,8,16,32,64],\"device\":[\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\"],\"device_mem\":[39,55,89,284,497,979,1941],\"index\":[120,121,122,123,124,125,126],\"model\":[\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\"],\"throughput\":{\"__ndarray__\":\"Ph5+uzN6WEBN9gp6rgleQCp71s0Hw2NAw3ItwHpUZ0BeEo23ANFuQAU7Imnn6HBA8y1ZmGqicUA=\",\"dtype\":\"float64\",\"shape\":[7]},\"workload\":[\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\"]}},\"id\":\"1ee27e38-d7cf-4c5b-9567-b06b9cdb7fd6\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"data_source\":{\"id\":\"1ee27e38-d7cf-4c5b-9567-b06b9cdb7fd6\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"6dcfc765-6902-4ef1-bf2d-7e9870a9f3d9\",\"type\":\"Circle\"},\"hover_glyph\":null,\"muted_glyph\":null,\"nonselection_glyph\":{\"id\":\"c0174f8d-6f91-4394-be34-b34ebfaf06a9\",\"type\":\"Circle\"},\"selection_glyph\":null,\"view\":{\"id\":\"d5f1a270-38d0-43f5-8efe-3d0f209a2237\",\"type\":\"CDSView\"}},\"id\":\"4da425fa-6b13-49b3-8826-dca31c0a6ba7\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"050250c2-5546-482a-8a63-d19a61ec6922\",\"type\":\"HoverTool\"}]},\"id\":\"89e54caf-bab3-4899-ae92-a0b1bbe43474\",\"type\":\"Toolbar\"},{\"attributes\":{\"plot\":null,\"text\":\"\"},\"id\":\"2b1b0067-949f-492f-a4e7-b49d95efa591\",\"type\":\"Title\"},{\"attributes\":{\"callback\":null},\"id\":\"8dbc18bb-63dc-45fc-8461-7fa6bc6a8dab\",\"type\":\"DataRange1d\"},{\"attributes\":{\"source\":{\"id\":\"1ee27e38-d7cf-4c5b-9567-b06b9cdb7fd6\",\"type\":\"ColumnDataSource\"}},\"id\":\"d5f1a270-38d0-43f5-8efe-3d0f209a2237\",\"type\":\"CDSView\"},{\"attributes\":{\"callback\":null},\"id\":\"849d6afa-66ed-4b28-91e9-1126ac30c54b\",\"type\":\"DataRange1d\"}],\"root_ids\":[\"d9d32e09-082e-4ba6-97aa-463d4c307c28\"]},\"title\":\"Bokeh Application\",\"version\":\"0.12.13\"}};\n  var render_items = [{\"docid\":\"ef49c8a3-de5e-4ecd-bf9d-05cd70c38698\",\"elementid\":\"d6115730-4dc1-4cbd-9141-b3c993a92a57\",\"modelid\":\"d9d32e09-082e-4ba6-97aa-463d4c307c28\"}];\n  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n\n  }\n  if (root.Bokeh !== undefined) {\n    embed_document(root);\n  } else {\n    var attempts = 0;\n    var timer = setInterval(function(root) {\n      if (root.Bokeh !== undefined) {\n        embed_document(root);\n        clearInterval(timer);\n      }\n      attempts++;\n      if (attempts > 100) {\n        console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\")\n        clearInterval(timer);\n      }\n    }, 10, root)\n  }\n})(window);",
   "application/vnd.bokehjs_exec.v0+json": ""
  },
  "metadata": {
   "application/vnd.bokehjs_exec.v0+json": {
    "id": "d9d32e09-082e-4ba6-97aa-463d4c307c28"
   }
  },
  "output_type": "display_data"
 }
]
```

```{.python .input  n=5}
import numpy as np
from bokeh import palettes
from bokeh.layouts import gridplot

def batch_size_vs_throughput_grid(data, models):
    assert 'batch_size' in data.columns, data.columns
    assert 'throughput' in data.columns, data.columns
    assert 'model' in data.columns, data.columns
    
    data = data.copy()
    if ('device_mem' in data.columns and 
        not 'size' in data.columns):
        size = np.log(data.device_mem.values)
        data['size'] = 20 * size / size.max()
    
    colors = palettes.Set2[max(len(models),3)]  
    plots = []
    for model, color in zip(models, colors):
        p = batch_size_vs_throughput(data[data.model == model], color)
        p.title.text = model
        plots.append(p)
    return gridplot(plots, ncols=2, toolbar_location="")

models = ['DensetNet-121', 'ResNet-v1-101', 'VGG-11', 'AlexNet']

grid = batch_size_vs_throughput_grid(thr, models)

show(grid)
```

```{.json .output n=5}
[
 {
  "data": {
   "text/html": "\n<div class=\"bk-root\">\n    <div class=\"bk-plotdiv\" id=\"1f4385b6-cb49-4958-b431-d7ef88dcc3ca\"></div>\n</div>"
  },
  "metadata": {},
  "output_type": "display_data"
 },
 {
  "data": {
   "application/javascript": "(function(root) {\n  function embed_document(root) {\n    \n  var docs_json = {\"cb5ca5bc-d36c-47e6-9b24-da23814df2a6\":{\"roots\":{\"references\":[{\"attributes\":{},\"id\":\"a39cc1e9-02a0-4a9f-8fee-8bb7c42d3234\",\"type\":\"LinearScale\"},{\"attributes\":{\"callback\":null},\"id\":\"cd75ce27-580f-48d8-b523-41c3fc9b143e\",\"type\":\"DataRange1d\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"49a5526f-6f95-4ece-9d97-fc34ffa726fc\",\"type\":\"HoverTool\"}]},\"id\":\"bc3645a7-a14e-4b81-843b-3b09da31440a\",\"type\":\"Toolbar\"},{\"attributes\":{},\"id\":\"11fcf1a2-a6e1-4c7f-ae69-ac28e337d9a3\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"673a028b-3f38-4368-8c53-e37be0c4abf4\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"e083f0ca-8110-480b-acdd-eb1294fab2e2\",\"type\":\"LinearScale\"},{\"attributes\":{\"callback\":null,\"tooltips\":[[\"Throughput\",\"@throughput\"],[\"Batch size\",\"@batch_size\"],[\"Device memory\",\"@device_mem MB\"]]},\"id\":\"622402a2-28dd-41da-a145-c0b36d4ba80e\",\"type\":\"HoverTool\"},{\"attributes\":{\"dimension\":1,\"plot\":{\"id\":\"a26c91b4-9f7c-43b8-818b-63f08f919747\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"673a028b-3f38-4368-8c53-e37be0c4abf4\",\"type\":\"BasicTicker\"}},\"id\":\"19fc1c9a-ade6-4623-9938-5b2c9e47b9f0\",\"type\":\"Grid\"},{\"attributes\":{\"callback\":null,\"column_names\":[\"batch_size\",\"device\",\"device_mem\",\"model\",\"throughput\",\"workload\",\"size\",\"index\"],\"data\":{\"batch_size\":[1,2,4,8,16,32,64,128],\"device\":[\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\"],\"device_mem\":[14,16,19,50,67,114,222,527],\"index\":[0,1,2,3,4,5,6,7],\"model\":[\"AlexNet\",\"AlexNet\",\"AlexNet\",\"AlexNet\",\"AlexNet\",\"AlexNet\",\"AlexNet\",\"AlexNet\"],\"size\":{\"__ndarray__\":\"A4Il2xrpGkAPnQlJrkUcQDpQqi1JBh5AWnU7vw3yI0Ad1lRaDXAlQD0cLtzIJShA3IZ9z6+LK0AIiE6SFPQvQA==\",\"dtype\":\"float64\",\"shape\":[8]},\"throughput\":{\"__ndarray__\":\"Jy5MYHAXcUDOJy0a2hh6QLJkzcavHYlAH75dy5GYlED9g7FSGgCYQPrHHAk7MaFAYsi1fJfJpECTYXfW6JymQA==\",\"dtype\":\"float64\",\"shape\":[8]},\"workload\":[\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\"]}},\"id\":\"594e3352-2975-496c-9565-1f5637f9df78\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"dimension\":1,\"plot\":{\"id\":\"1116c058-2435-4af1-ae89-b76b2cd56ec5\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"2489049c-3213-423a-b26b-1815e1d45751\",\"type\":\"BasicTicker\"}},\"id\":\"09bf6188-a423-4112-8f32-035dd3219ee7\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"349b2685-48dd-4b65-a2b5-01cd08e1ffb9\",\"type\":\"BasicTicker\"},{\"attributes\":{\"callback\":null,\"column_names\":[\"batch_size\",\"device\",\"device_mem\",\"model\",\"throughput\",\"workload\",\"size\",\"index\"],\"data\":{\"batch_size\":[1,2,4,8,16,32,64],\"device\":[\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\"],\"device_mem\":[39,55,89,284,497,979,1941],\"index\":[120,121,122,123,124,125,126],\"model\":[\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\",\"VGG-11\"],\"size\":{\"__ndarray__\":\"+fnCu8GtIkBphdBbdG4kQLDNOlSp4iZArSemlSjNLEDJTdWnlKcvQB4Zf9o4jjFAGs773uJMM0A=\",\"dtype\":\"float64\",\"shape\":[7]},\"throughput\":{\"__ndarray__\":\"Ph5+uzN6WEBN9gp6rgleQCp71s0Hw2NAw3ItwHpUZ0BeEo23ANFuQAU7Imnn6HBA8y1ZmGqicUA=\",\"dtype\":\"float64\",\"shape\":[7]},\"workload\":[\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\"]}},\"id\":\"2bb1ed21-cd34-4844-94ef-fb5ee5e9e3a7\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"callback\":null},\"id\":\"9ebd46be-5386-47d2-8bc9-0c3c76ec7778\",\"type\":\"DataRange1d\"},{\"attributes\":{\"axis_label\":\"#examples / sec\",\"formatter\":{\"id\":\"b9a9f500-e3ce-400a-a878-f50e0ae1d021\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"a26c91b4-9f7c-43b8-818b-63f08f919747\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"673a028b-3f38-4368-8c53-e37be0c4abf4\",\"type\":\"BasicTicker\"}},\"id\":\"571c29f7-c6f3-497f-8265-736ce3f24f2c\",\"type\":\"LinearAxis\"},{\"attributes\":{\"plot\":{\"id\":\"a26c91b4-9f7c-43b8-818b-63f08f919747\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"349b2685-48dd-4b65-a2b5-01cd08e1ffb9\",\"type\":\"BasicTicker\"}},\"id\":\"0e1b57c9-5daa-4899-8aca-3101ed17ddee\",\"type\":\"Grid\"},{\"attributes\":{\"axis_label\":\"batch size\",\"formatter\":{\"id\":\"cd1509aa-d950-46d8-863b-8c90cd9feba5\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"a26c91b4-9f7c-43b8-818b-63f08f919747\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"349b2685-48dd-4b65-a2b5-01cd08e1ffb9\",\"type\":\"BasicTicker\"}},\"id\":\"1fddc920-fad5-426a-9316-9fc124529dc4\",\"type\":\"LinearAxis\"},{\"attributes\":{\"callback\":null},\"id\":\"b3d0d3b3-22fc-4df2-a738-5a5fd74751b9\",\"type\":\"DataRange1d\"},{\"attributes\":{\"below\":[{\"id\":\"73c48fac-de38-4d2b-853b-5000021337dd\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"58db063b-d969-49c6-a512-73275ea5b345\",\"type\":\"LinearAxis\"}],\"plot_height\":250,\"plot_width\":250,\"renderers\":[{\"id\":\"73c48fac-de38-4d2b-853b-5000021337dd\",\"type\":\"LinearAxis\"},{\"id\":\"dcf3c38f-d806-410c-8322-5749e82d1463\",\"type\":\"Grid\"},{\"id\":\"58db063b-d969-49c6-a512-73275ea5b345\",\"type\":\"LinearAxis\"},{\"id\":\"1604a382-48ce-4cc3-9f38-674a4c5071e5\",\"type\":\"Grid\"},{\"id\":\"56114221-6992-4735-bcf5-e625f831235f\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"c64d5ae4-2e15-4a3d-a9e8-32211ae877d6\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"945d67df-9d84-406d-9e99-cef3ee2b0620\",\"type\":\"Toolbar\"},\"toolbar_location\":null,\"x_range\":{\"id\":\"868ed20e-4a31-4d8c-adcc-333611e27ce0\",\"type\":\"DataRange1d\"},\"x_scale\":{\"id\":\"557f6d8f-c0ff-4572-b5d1-4404de66c698\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"c89a4dea-ae92-4471-bfc9-e792d9eddc34\",\"type\":\"DataRange1d\"},\"y_scale\":{\"id\":\"3f67c996-2b39-4497-a8d3-90af764717c6\",\"type\":\"LinearScale\"}},\"id\":\"cd1d73dc-8244-42bd-88dd-ffccf153c523\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{},\"id\":\"b9a9f500-e3ce-400a-a878-f50e0ae1d021\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"plot\":null,\"text\":\"VGG-11\"},\"id\":\"97500c31-d85b-4b52-ba0b-9a1cc0de3eb4\",\"type\":\"Title\"},{\"attributes\":{\"source\":{\"id\":\"2bb1ed21-cd34-4844-94ef-fb5ee5e9e3a7\",\"type\":\"ColumnDataSource\"}},\"id\":\"7c78c718-fcab-47c3-aff0-a1b1a76b044a\",\"type\":\"CDSView\"},{\"attributes\":{\"data_source\":{\"id\":\"2bb1ed21-cd34-4844-94ef-fb5ee5e9e3a7\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"467d5d4d-e31c-4027-a9bc-1b100ec27cef\",\"type\":\"Circle\"},\"hover_glyph\":null,\"muted_glyph\":null,\"nonselection_glyph\":{\"id\":\"2035319c-ebc4-4adc-8ed2-135328cd82a9\",\"type\":\"Circle\"},\"selection_glyph\":null,\"view\":{\"id\":\"7c78c718-fcab-47c3-aff0-a1b1a76b044a\",\"type\":\"CDSView\"}},\"id\":\"b830b963-5a9e-48cb-8db6-ea71130a4608\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"below\":[{\"id\":\"cd149f3d-2a0e-48f2-a92c-63c338fda91e\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"58ae0df4-831e-44c5-84f8-60615453fcbc\",\"type\":\"LinearAxis\"}],\"plot_height\":250,\"plot_width\":250,\"renderers\":[{\"id\":\"cd149f3d-2a0e-48f2-a92c-63c338fda91e\",\"type\":\"LinearAxis\"},{\"id\":\"e31d41b9-33ef-42ac-8993-aa9c438797fc\",\"type\":\"Grid\"},{\"id\":\"58ae0df4-831e-44c5-84f8-60615453fcbc\",\"type\":\"LinearAxis\"},{\"id\":\"fce884f5-de02-4c68-adf3-3ab7f1fa5c71\",\"type\":\"Grid\"},{\"id\":\"9cb5f0f2-b835-499a-8fd5-6ba2530d08a7\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"45cb9f9d-c9a0-4e99-8046-2d7556aba5eb\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"d6b84582-7394-4c93-9d58-0a7a96a1adef\",\"type\":\"Toolbar\"},\"toolbar_location\":null,\"x_range\":{\"id\":\"b3d0d3b3-22fc-4df2-a738-5a5fd74751b9\",\"type\":\"DataRange1d\"},\"x_scale\":{\"id\":\"19c49a3b-833e-47fd-a091-29a5352df9f1\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"9527edbb-f9ac-42be-86d6-5dc6d3256031\",\"type\":\"DataRange1d\"},\"y_scale\":{\"id\":\"c9cc54b4-ef1f-4ad0-a8f5-964c882ea894\",\"type\":\"LinearScale\"}},\"id\":\"f369d64e-d861-41c5-a9eb-8cca73213ace\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"callback\":null,\"tooltips\":[[\"Throughput\",\"@throughput\"],[\"Batch size\",\"@batch_size\"],[\"Device memory\",\"@device_mem MB\"]]},\"id\":\"49a5526f-6f95-4ece-9d97-fc34ffa726fc\",\"type\":\"HoverTool\"},{\"attributes\":{},\"id\":\"cd1509aa-d950-46d8-863b-8c90cd9feba5\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"callback\":null},\"id\":\"9527edbb-f9ac-42be-86d6-5dc6d3256031\",\"type\":\"DataRange1d\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"49014946-6965-4077-bf8f-8753494d408e\",\"type\":\"HoverTool\"}]},\"id\":\"945d67df-9d84-406d-9e99-cef3ee2b0620\",\"type\":\"Toolbar\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"32e2f967-0880-47e4-a8b3-cf5e2bc5c0fb\",\"type\":\"HoverTool\"}]},\"id\":\"d6b84582-7394-4c93-9d58-0a7a96a1adef\",\"type\":\"Toolbar\"},{\"attributes\":{\"callback\":null,\"tooltips\":[[\"Throughput\",\"@throughput\"],[\"Batch size\",\"@batch_size\"],[\"Device memory\",\"@device_mem MB\"]]},\"id\":\"49014946-6965-4077-bf8f-8753494d408e\",\"type\":\"HoverTool\"},{\"attributes\":{},\"id\":\"19c49a3b-833e-47fd-a091-29a5352df9f1\",\"type\":\"LinearScale\"},{\"attributes\":{\"children\":[{\"id\":\"cd1d73dc-8244-42bd-88dd-ffccf153c523\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"id\":\"1116c058-2435-4af1-ae89-b76b2cd56ec5\",\"subtype\":\"Figure\",\"type\":\"Plot\"}]},\"id\":\"1010a5a8-1761-4b32-9c58-68a3f07396c9\",\"type\":\"Row\"},{\"attributes\":{},\"id\":\"c9cc54b4-ef1f-4ad0-a8f5-964c882ea894\",\"type\":\"LinearScale\"},{\"attributes\":{\"plot\":{\"id\":\"f369d64e-d861-41c5-a9eb-8cca73213ace\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"b56be716-8d5f-4a9a-8cc9-c933396ca5d5\",\"type\":\"BasicTicker\"}},\"id\":\"e31d41b9-33ef-42ac-8993-aa9c438797fc\",\"type\":\"Grid\"},{\"attributes\":{\"children\":[{\"id\":\"1010a5a8-1761-4b32-9c58-68a3f07396c9\",\"type\":\"Row\"},{\"id\":\"78372de2-20d8-4952-89c5-eb90890bc9d8\",\"type\":\"Row\"}]},\"id\":\"afb088af-44b3-4ccf-ab55-0be1bc5bbd42\",\"type\":\"Column\"},{\"attributes\":{\"axis_label\":\"batch size\",\"formatter\":{\"id\":\"11c3cf23-3b5b-4a52-981b-f1ea10c66123\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"f369d64e-d861-41c5-a9eb-8cca73213ace\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"b56be716-8d5f-4a9a-8cc9-c933396ca5d5\",\"type\":\"BasicTicker\"}},\"id\":\"cd149f3d-2a0e-48f2-a92c-63c338fda91e\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"b56be716-8d5f-4a9a-8cc9-c933396ca5d5\",\"type\":\"BasicTicker\"},{\"attributes\":{\"axis_label\":\"#examples / sec\",\"formatter\":{\"id\":\"6573dda0-5ee8-41e2-b64a-5e99cc4f14f4\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"f369d64e-d861-41c5-a9eb-8cca73213ace\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"34d61430-c98f-4382-ba1f-68739d73df04\",\"type\":\"BasicTicker\"}},\"id\":\"58ae0df4-831e-44c5-84f8-60615453fcbc\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"34d61430-c98f-4382-ba1f-68739d73df04\",\"type\":\"BasicTicker\"},{\"attributes\":{\"dimension\":1,\"plot\":{\"id\":\"f369d64e-d861-41c5-a9eb-8cca73213ace\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"34d61430-c98f-4382-ba1f-68739d73df04\",\"type\":\"BasicTicker\"}},\"id\":\"fce884f5-de02-4c68-adf3-3ab7f1fa5c71\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"6573dda0-5ee8-41e2-b64a-5e99cc4f14f4\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"8c8a756f-f70f-4431-a20e-31ba849fe472\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"fill_color\":{\"value\":\"#66c2a5\"},\"line_color\":{\"value\":\"#66c2a5\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"f420f24e-eb38-4dfb-b84c-20dc58e3e769\",\"type\":\"Circle\"},{\"attributes\":{\"callback\":null,\"column_names\":[\"batch_size\",\"device\",\"device_mem\",\"model\",\"throughput\",\"workload\",\"size\",\"index\"],\"data\":{\"batch_size\":[1,2,4,8,16,32,64,128],\"device\":[\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\"],\"device_mem\":[10,18,34,70,137,274,548,1093],\"index\":[8,9,10,11,12,13,14,15],\"model\":[\"DensetNet-121\",\"DensetNet-121\",\"DensetNet-121\",\"DensetNet-121\",\"DensetNet-121\",\"DensetNet-121\",\"DensetNet-121\",\"DensetNet-121\"],\"size\":{\"__ndarray__\":\"/ahciMN6F0A5aSGDJXkdQNebENSt+iFA3uGfaDmpJUBGjBdMqRUpQOm/OBVfnixAxfksb4oTMEA8zH5lG9YxQA==\",\"dtype\":\"float64\",\"shape\":[8]},\"throughput\":{\"__ndarray__\":\"OzNQyiO6SED9aK6tKu5UQA4KM8Qmt15AH/vZFHzHY0DkSb3PmZRnQD0fk5thhWlAAqsYg8OLakDB7j5ixJRqQA==\",\"dtype\":\"float64\",\"shape\":[8]},\"workload\":[\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\"]}},\"id\":\"c7ff1271-7535-43f5-a4e8-f737a990f9d6\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"children\":[{\"id\":\"a26c91b4-9f7c-43b8-818b-63f08f919747\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"id\":\"f369d64e-d861-41c5-a9eb-8cca73213ace\",\"subtype\":\"Figure\",\"type\":\"Plot\"}]},\"id\":\"78372de2-20d8-4952-89c5-eb90890bc9d8\",\"type\":\"Row\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"value\":\"#1f77b4\"},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"value\":\"#1f77b4\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"2ccc239f-d18a-49f6-92a3-116a65294182\",\"type\":\"Circle\"},{\"attributes\":{\"plot\":null,\"text\":\"AlexNet\"},\"id\":\"45cb9f9d-c9a0-4e99-8046-2d7556aba5eb\",\"type\":\"Title\"},{\"attributes\":{\"plot\":null,\"text\":\"DensetNet-121\"},\"id\":\"c64d5ae4-2e15-4a3d-a9e8-32211ae877d6\",\"type\":\"Title\"},{\"attributes\":{\"source\":{\"id\":\"594e3352-2975-496c-9565-1f5637f9df78\",\"type\":\"ColumnDataSource\"}},\"id\":\"2e3435cc-d1d3-439b-8901-1dfde432f370\",\"type\":\"CDSView\"},{\"attributes\":{\"source\":{\"id\":\"c7ff1271-7535-43f5-a4e8-f737a990f9d6\",\"type\":\"ColumnDataSource\"}},\"id\":\"15a1370b-43fb-47ad-9617-225356390d3f\",\"type\":\"CDSView\"},{\"attributes\":{\"data_source\":{\"id\":\"594e3352-2975-496c-9565-1f5637f9df78\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"7c8bc8cc-3716-459c-bc01-5a2e9adde0b1\",\"type\":\"Circle\"},\"hover_glyph\":null,\"muted_glyph\":null,\"nonselection_glyph\":{\"id\":\"d208327c-07fe-4b38-acac-5d23bca6275d\",\"type\":\"Circle\"},\"selection_glyph\":null,\"view\":{\"id\":\"2e3435cc-d1d3-439b-8901-1dfde432f370\",\"type\":\"CDSView\"}},\"id\":\"9cb5f0f2-b835-499a-8fd5-6ba2530d08a7\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"data_source\":{\"id\":\"c7ff1271-7535-43f5-a4e8-f737a990f9d6\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"f420f24e-eb38-4dfb-b84c-20dc58e3e769\",\"type\":\"Circle\"},\"hover_glyph\":null,\"muted_glyph\":null,\"nonselection_glyph\":{\"id\":\"2ccc239f-d18a-49f6-92a3-116a65294182\",\"type\":\"Circle\"},\"selection_glyph\":null,\"view\":{\"id\":\"15a1370b-43fb-47ad-9617-225356390d3f\",\"type\":\"CDSView\"}},\"id\":\"56114221-6992-4735-bcf5-e625f831235f\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"source\":{\"id\":\"b5fd2945-152a-4657-a4e9-16cdfd9fd22d\",\"type\":\"ColumnDataSource\"}},\"id\":\"3e6457f5-8e5a-41fe-a555-22e345fcabab\",\"type\":\"CDSView\"},{\"attributes\":{\"below\":[{\"id\":\"bdca556d-9a53-413a-bc5e-5e3c23557673\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"52676558-826f-42eb-b3d9-3035e9c07055\",\"type\":\"LinearAxis\"}],\"plot_height\":250,\"plot_width\":250,\"renderers\":[{\"id\":\"bdca556d-9a53-413a-bc5e-5e3c23557673\",\"type\":\"LinearAxis\"},{\"id\":\"717deedf-e190-4888-8a3e-009cb3753e4e\",\"type\":\"Grid\"},{\"id\":\"52676558-826f-42eb-b3d9-3035e9c07055\",\"type\":\"LinearAxis\"},{\"id\":\"09bf6188-a423-4112-8f32-035dd3219ee7\",\"type\":\"Grid\"},{\"id\":\"b64aff5e-411e-4a8c-a154-2a76ec55e4ab\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"6f49e432-dbc5-4de1-b20d-d367341769b4\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"457461cf-78c0-4d12-96ce-d1afe74c5bd4\",\"type\":\"Toolbar\"},\"toolbar_location\":null,\"x_range\":{\"id\":\"a39edc43-d127-4b92-89f5-01e82956969d\",\"type\":\"DataRange1d\"},\"x_scale\":{\"id\":\"080545f9-6dd9-47d4-8f01-6ab65add1363\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"59aebde1-a1b4-48b1-8025-62fd3d8dd978\",\"type\":\"DataRange1d\"},\"y_scale\":{\"id\":\"30916e36-239c-4bf2-9b82-30486180119c\",\"type\":\"LinearScale\"}},\"id\":\"1116c058-2435-4af1-ae89-b76b2cd56ec5\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"value\":\"#1f77b4\"},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"value\":\"#1f77b4\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"d208327c-07fe-4b38-acac-5d23bca6275d\",\"type\":\"Circle\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"622402a2-28dd-41da-a145-c0b36d4ba80e\",\"type\":\"HoverTool\"}]},\"id\":\"457461cf-78c0-4d12-96ce-d1afe74c5bd4\",\"type\":\"Toolbar\"},{\"attributes\":{\"fill_color\":{\"value\":\"#fc8d62\"},\"line_color\":{\"value\":\"#fc8d62\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"138b8191-696d-4030-91b6-f47a7421f364\",\"type\":\"Circle\"},{\"attributes\":{\"fill_color\":{\"value\":\"#e78ac3\"},\"line_color\":{\"value\":\"#e78ac3\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"7c8bc8cc-3716-459c-bc01-5a2e9adde0b1\",\"type\":\"Circle\"},{\"attributes\":{},\"id\":\"3f67c996-2b39-4497-a8d3-90af764717c6\",\"type\":\"LinearScale\"},{\"attributes\":{\"data_source\":{\"id\":\"b5fd2945-152a-4657-a4e9-16cdfd9fd22d\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"138b8191-696d-4030-91b6-f47a7421f364\",\"type\":\"Circle\"},\"hover_glyph\":null,\"muted_glyph\":null,\"nonselection_glyph\":{\"id\":\"598b8156-fdb8-4e1f-be78-61166f7d99b1\",\"type\":\"Circle\"},\"selection_glyph\":null,\"view\":{\"id\":\"3e6457f5-8e5a-41fe-a555-22e345fcabab\",\"type\":\"CDSView\"}},\"id\":\"b64aff5e-411e-4a8c-a154-2a76ec55e4ab\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"callback\":null,\"tooltips\":[[\"Throughput\",\"@throughput\"],[\"Batch size\",\"@batch_size\"],[\"Device memory\",\"@device_mem MB\"]]},\"id\":\"32e2f967-0880-47e4-a8b3-cf5e2bc5c0fb\",\"type\":\"HoverTool\"},{\"attributes\":{\"plot\":{\"id\":\"cd1d73dc-8244-42bd-88dd-ffccf153c523\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"60043477-a68a-439b-8c33-25e2506184ed\",\"type\":\"BasicTicker\"}},\"id\":\"dcf3c38f-d806-410c-8322-5749e82d1463\",\"type\":\"Grid\"},{\"attributes\":{\"plot\":null,\"text\":\"ResNet-v1-101\"},\"id\":\"6f49e432-dbc5-4de1-b20d-d367341769b4\",\"type\":\"Title\"},{\"attributes\":{},\"id\":\"11c3cf23-3b5b-4a52-981b-f1ea10c66123\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"axis_label\":\"batch size\",\"formatter\":{\"id\":\"204a2ffc-2a1e-4116-9909-4330b9903739\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"cd1d73dc-8244-42bd-88dd-ffccf153c523\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"60043477-a68a-439b-8c33-25e2506184ed\",\"type\":\"BasicTicker\"}},\"id\":\"73c48fac-de38-4d2b-853b-5000021337dd\",\"type\":\"LinearAxis\"},{\"attributes\":{\"callback\":null},\"id\":\"a39edc43-d127-4b92-89f5-01e82956969d\",\"type\":\"DataRange1d\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"value\":\"#1f77b4\"},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"value\":\"#1f77b4\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"598b8156-fdb8-4e1f-be78-61166f7d99b1\",\"type\":\"Circle\"},{\"attributes\":{},\"id\":\"c73cb368-c0c9-42df-8ed8-d0aa4dd2ccf4\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"60043477-a68a-439b-8c33-25e2506184ed\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"85524bcc-53a8-45c0-b973-24a885fd5075\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"axis_label\":\"#examples / sec\",\"formatter\":{\"id\":\"8c8a756f-f70f-4431-a20e-31ba849fe472\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"cd1d73dc-8244-42bd-88dd-ffccf153c523\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"c73cb368-c0c9-42df-8ed8-d0aa4dd2ccf4\",\"type\":\"BasicTicker\"}},\"id\":\"58db063b-d969-49c6-a512-73275ea5b345\",\"type\":\"LinearAxis\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"value\":\"#1f77b4\"},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"value\":\"#1f77b4\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"2035319c-ebc4-4adc-8ed2-135328cd82a9\",\"type\":\"Circle\"},{\"attributes\":{\"dimension\":1,\"plot\":{\"id\":\"cd1d73dc-8244-42bd-88dd-ffccf153c523\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"c73cb368-c0c9-42df-8ed8-d0aa4dd2ccf4\",\"type\":\"BasicTicker\"}},\"id\":\"1604a382-48ce-4cc3-9f38-674a4c5071e5\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"557f6d8f-c0ff-4572-b5d1-4404de66c698\",\"type\":\"LinearScale\"},{\"attributes\":{\"callback\":null},\"id\":\"c89a4dea-ae92-4471-bfc9-e792d9eddc34\",\"type\":\"DataRange1d\"},{\"attributes\":{\"callback\":null},\"id\":\"868ed20e-4a31-4d8c-adcc-333611e27ce0\",\"type\":\"DataRange1d\"},{\"attributes\":{\"callback\":null,\"column_names\":[\"batch_size\",\"device\",\"device_mem\",\"model\",\"throughput\",\"workload\",\"size\",\"index\"],\"data\":{\"batch_size\":[1,2,4,8,16,32,64,128],\"device\":[\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\"],\"device_mem\":[27,37,56,84,164,324,758,1514],\"index\":[40,41,42,43,44,45,46,47],\"model\":[\"ResNet-v1-101\",\"ResNet-v1-101\",\"ResNet-v1-101\",\"ResNet-v1-101\",\"ResNet-v1-101\",\"ResNet-v1-101\",\"ResNet-v1-101\",\"ResNet-v1-101\"],\"size\":{\"__ndarray__\":\"eEGndMvNIEC8kiSKC2kiQEYo1f/4hSRAIbXrsjGXJkB9XtKccwAqQDlpIYMleS1AF7wIu0DnMEALDT0Sv6oyQA==\",\"dtype\":\"float64\",\"shape\":[8]},\"throughput\":{\"__ndarray__\":\"0VDxxJ+7REDdUzG8KKhQQMj+RFmFJlZA6hKduuHVWUAcN00U40BcQJCKw+Ni4V1AV4iYsWc0XUAgayayaulfQA==\",\"dtype\":\"float64\",\"shape\":[8]},\"workload\":[\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\"]}},\"id\":\"b5fd2945-152a-4657-a4e9-16cdfd9fd22d\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"204a2ffc-2a1e-4116-9909-4330b9903739\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"below\":[{\"id\":\"1fddc920-fad5-426a-9316-9fc124529dc4\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"571c29f7-c6f3-497f-8265-736ce3f24f2c\",\"type\":\"LinearAxis\"}],\"plot_height\":250,\"plot_width\":250,\"renderers\":[{\"id\":\"1fddc920-fad5-426a-9316-9fc124529dc4\",\"type\":\"LinearAxis\"},{\"id\":\"0e1b57c9-5daa-4899-8aca-3101ed17ddee\",\"type\":\"Grid\"},{\"id\":\"571c29f7-c6f3-497f-8265-736ce3f24f2c\",\"type\":\"LinearAxis\"},{\"id\":\"19fc1c9a-ade6-4623-9938-5b2c9e47b9f0\",\"type\":\"Grid\"},{\"id\":\"b830b963-5a9e-48cb-8db6-ea71130a4608\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"97500c31-d85b-4b52-ba0b-9a1cc0de3eb4\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"bc3645a7-a14e-4b81-843b-3b09da31440a\",\"type\":\"Toolbar\"},\"toolbar_location\":null,\"x_range\":{\"id\":\"cd75ce27-580f-48d8-b523-41c3fc9b143e\",\"type\":\"DataRange1d\"},\"x_scale\":{\"id\":\"a39cc1e9-02a0-4a9f-8fee-8bb7c42d3234\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"9ebd46be-5386-47d2-8bc9-0c3c76ec7778\",\"type\":\"DataRange1d\"},\"y_scale\":{\"id\":\"e083f0ca-8110-480b-acdd-eb1294fab2e2\",\"type\":\"LinearScale\"}},\"id\":\"a26c91b4-9f7c-43b8-818b-63f08f919747\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{},\"id\":\"ef341dfb-84ae-4cc1-a3f5-8a06e1709420\",\"type\":\"BasicTicker\"},{\"attributes\":{\"axis_label\":\"batch size\",\"formatter\":{\"id\":\"11fcf1a2-a6e1-4c7f-ae69-ac28e337d9a3\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"1116c058-2435-4af1-ae89-b76b2cd56ec5\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"ef341dfb-84ae-4cc1-a3f5-8a06e1709420\",\"type\":\"BasicTicker\"}},\"id\":\"bdca556d-9a53-413a-bc5e-5e3c23557673\",\"type\":\"LinearAxis\"},{\"attributes\":{\"axis_label\":\"#examples / sec\",\"formatter\":{\"id\":\"85524bcc-53a8-45c0-b973-24a885fd5075\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"1116c058-2435-4af1-ae89-b76b2cd56ec5\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"2489049c-3213-423a-b26b-1815e1d45751\",\"type\":\"BasicTicker\"}},\"id\":\"52676558-826f-42eb-b3d9-3035e9c07055\",\"type\":\"LinearAxis\"},{\"attributes\":{\"plot\":{\"id\":\"1116c058-2435-4af1-ae89-b76b2cd56ec5\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"ef341dfb-84ae-4cc1-a3f5-8a06e1709420\",\"type\":\"BasicTicker\"}},\"id\":\"717deedf-e190-4888-8a3e-009cb3753e4e\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"30916e36-239c-4bf2-9b82-30486180119c\",\"type\":\"LinearScale\"},{\"attributes\":{\"fill_color\":{\"value\":\"#8da0cb\"},\"line_color\":{\"value\":\"#8da0cb\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"batch_size\"},\"y\":{\"field\":\"throughput\"}},\"id\":\"467d5d4d-e31c-4027-a9bc-1b100ec27cef\",\"type\":\"Circle\"},{\"attributes\":{},\"id\":\"080545f9-6dd9-47d4-8f01-6ab65add1363\",\"type\":\"LinearScale\"},{\"attributes\":{\"callback\":null},\"id\":\"59aebde1-a1b4-48b1-8025-62fd3d8dd978\",\"type\":\"DataRange1d\"},{\"attributes\":{},\"id\":\"2489049c-3213-423a-b26b-1815e1d45751\",\"type\":\"BasicTicker\"}],\"root_ids\":[\"afb088af-44b3-4ccf-ab55-0be1bc5bbd42\"]},\"title\":\"Bokeh Application\",\"version\":\"0.12.13\"}};\n  var render_items = [{\"docid\":\"cb5ca5bc-d36c-47e6-9b24-da23814df2a6\",\"elementid\":\"1f4385b6-cb49-4958-b431-d7ef88dcc3ca\",\"modelid\":\"afb088af-44b3-4ccf-ab55-0be1bc5bbd42\"}];\n  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n\n  }\n  if (root.Bokeh !== undefined) {\n    embed_document(root);\n  } else {\n    var attempts = 0;\n    var timer = setInterval(function(root) {\n      if (root.Bokeh !== undefined) {\n        embed_document(root);\n        clearInterval(timer);\n      }\n      attempts++;\n      if (attempts > 100) {\n        console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\")\n        clearInterval(timer);\n      }\n    }, 10, root)\n  }\n})(window);",
   "application/vnd.bokehjs_exec.v0+json": ""
  },
  "metadata": {
   "application/vnd.bokehjs_exec.v0+json": {
    "id": "afb088af-44b3-4ccf-ab55-0be1bc5bbd42"
   }
  },
  "output_type": "display_data"
 }
]
```

### Prediction accuracy versus throughput

```{.python .input  n=6}
!cat cnn*accuracy.json >acc.json
with open('acc.json', 'r') as f:
    acc = pd.DataFrame(json.load(f))

data = thr[(thr.model.isin(acc.model)) & 
           (thr.batch_size.isin(acc.batch_size))]
data = data.set_index('model').join(acc[['model','accuracy']].set_index('model'))    
data['model_prefix'] = [i[:i.rfind('-')] if i.rfind('-') > 0 else i for i in data.index]

```

```{.python .input  n=7}
from bokeh.transform import factor_cmap

def throughput_vs_accuracy(data):
    assert 'accuracy' in data.columns, data.columns
    assert ('model' in data.columns or 
            'model_prefix' in data.columns), data.columns
    model = 'model_prefix' if 'model_prefix' in data.columns else 'model'
    models = sorted(data[model].unique())
    colors = palettes.Category10[max(len(models),3)]
    index_cmap = factor_cmap(model, palette=colors, factors=models, end=1)
    
    data = data.copy()
    if ('device_mem' in data.columns and 
        not 'size' in data.columns):
        size = np.sqrt(data.device_mem.values)
        data['size'] = 30 * size / size.max()
        
    if 'size' in data.columns:
        size = 'size'
    else:
        size = 10
        
    p = figure(plot_width=600, plot_height=500, 
               toolbar_location=None, tools="")
    source = ColumnDataSource(data)
    
    p.scatter(x='throughput', y='accuracy', legend=model, 
              size=size, color=index_cmap, source=source)

    p.xaxis.axis_label = '#examples/sec'
    p.yaxis.axis_label = 'Accuracy'

    toolstips = [("Model", "@model"),
                 ("Throughput", "@throughput"),
                 ("Accuracy", "@accuracy")]
    if 'device_mem' in data.columns:
        toolstips.append(["Device memory", "@device_mem MB"])        
    p.add_tools(HoverTool(tooltips=toolstips))

    return p

p = throughput_vs_accuracy(data)
#output_notebook()
show(p)
```

```{.json .output n=7}
[
 {
  "data": {
   "text/html": "\n<div class=\"bk-root\">\n    <div class=\"bk-plotdiv\" id=\"8c89878a-6dca-411c-8cf4-b5d5f95a60a3\"></div>\n</div>"
  },
  "metadata": {},
  "output_type": "display_data"
 },
 {
  "data": {
   "application/javascript": "(function(root) {\n  function embed_document(root) {\n    \n  var docs_json = {\"af289611-c26b-47d5-aa53-50a05210f2e0\":{\"roots\":{\"references\":[{\"attributes\":{\"axis_label\":\"#examples/sec\",\"formatter\":{\"id\":\"c633dd42-40a0-4289-991a-67ae4d94b39f\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"fcc6da55-1d26-4cc6-a7e8-6ab76275fcf5\",\"type\":\"BasicTicker\"}},\"id\":\"9c834d8f-4afb-45ef-ba56-9318a54fff2f\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"fcc6da55-1d26-4cc6-a7e8-6ab76275fcf5\",\"type\":\"BasicTicker\"},{\"attributes\":{\"axis_label\":\"Accuracy\",\"formatter\":{\"id\":\"48673bba-7ca8-48a8-b859-f4090d0e6d68\",\"type\":\"BasicTickFormatter\"},\"plot\":{\"id\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"d5bb376c-3dc6-4cc9-875a-5347fc41c269\",\"type\":\"BasicTicker\"}},\"id\":\"741ac81e-ca48-4d82-8d00-aef4ab8086d6\",\"type\":\"LinearAxis\"},{\"attributes\":{\"end\":1,\"factors\":[\"AlexNet\",\"DensetNet\",\"ResNet-v1\",\"ResNet-v2\",\"SqueezeNet\",\"VGG\"],\"palette\":[\"#1f77b4\",\"#ff7f0e\",\"#2ca02c\",\"#d62728\",\"#9467bd\",\"#8c564b\"]},\"id\":\"a2be6a27-38b8-4164-a1fc-0c810d356780\",\"type\":\"CategoricalColorMapper\"},{\"attributes\":{},\"id\":\"d5bb376c-3dc6-4cc9-875a-5347fc41c269\",\"type\":\"BasicTicker\"},{\"attributes\":{\"callback\":null,\"tooltips\":[[\"Model\",\"@model\"],[\"Throughput\",\"@throughput\"],[\"Accuracy\",\"@accuracy\"],[\"Device memory\",\"@device_mem MB\"]]},\"id\":\"b7bcde55-93a0-440f-ac90-4fb156442e33\",\"type\":\"HoverTool\"},{\"attributes\":{\"dimension\":1,\"plot\":{\"id\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"d5bb376c-3dc6-4cc9-875a-5347fc41c269\",\"type\":\"BasicTicker\"}},\"id\":\"0fdbc3f0-fdde-42d4-902f-9f0b1d8fd642\",\"type\":\"Grid\"},{\"attributes\":{\"callback\":null,\"column_names\":[\"batch_size\",\"device\",\"device_mem\",\"throughput\",\"workload\",\"accuracy\",\"model_prefix\",\"size\",\"model\"],\"data\":{\"accuracy\":{\"__ndarray__\":\"fleLmzC/4T8d2TMQlQ7oP4ubML+rxeg/7RmISkd26D83YX5Xi5voP5+BqHRkT+g/a3ET5ne16D97BqLSkb3lP89AVDqy5+Y/NBCVjuyZ5z97BqLSkT3mP5jf1eImTOc/4NXiJszv5z9H9gxEpSPiP/pdLW7C/OE/bsL8rhY35T86smcgKp3lP06Y39XiJuY/GohKR/aM5j8=\",\"dtype\":\"float64\",\"shape\":[19]},\"batch_size\":[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],\"device\":[\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\",\"Tesla M60\"],\"device_mem\":[222,548,826,547,548,758,758,562,564,758,571,573,758,767,503,1941,2554,2554,2553],\"model\":[\"AlexNet\",\"DensetNet-121\",\"DensetNet-161\",\"DensetNet-169\",\"DensetNet-201\",\"ResNet-v1-101\",\"ResNet-v1-152\",\"ResNet-v1-18\",\"ResNet-v1-34\",\"ResNet-v1-50\",\"ResNet-v2-18\",\"ResNet-v2-34\",\"ResNet-v2-50\",\"SqueezeNet-1.0\",\"SqueezeNet-1.1\",\"VGG-11\",\"VGG-13\",\"VGG-16\",\"VGG-19\"],\"model_prefix\":[\"AlexNet\",\"DensetNet\",\"DensetNet\",\"DensetNet\",\"DensetNet\",\"ResNet-v1\",\"ResNet-v1\",\"ResNet-v1\",\"ResNet-v1\",\"ResNet-v1\",\"ResNet-v2\",\"ResNet-v2\",\"ResNet-v2\",\"SqueezeNet\",\"SqueezeNet\",\"VGG\",\"VGG\",\"VGG\",\"VGG\"],\"size\":{\"__ndarray__\":\"jsoTs4ewIUBS3gHU78orQGBu1kuUDzFA2u6tL3HEK0BS3gHU78orQF/IsnbwVzBAX8iydvBXMED8pdR1PyUsQPCQt6YOMixAX8iydvBXMEDqZVJGtl4sQCrFxJBrayxAX8iydvBXMECQJZtntHAwQEml1lmNoCpAT6R4JTMnOkAAAAAAAAA+QAAAAAAAAD5AH2RpD3/+PUA=\",\"dtype\":\"float64\",\"shape\":[19]},\"throughput\":{\"__ndarray__\":\"Ysi1fJfJpEACqxiDw4tqQJyZFaULUFdAQHUU5DCYZUD/EflPxExgQFeImLFnNF1AUB1nZfmfVEAiklLaiCqKQIOdTyzMmH1AQ6gT7V5xaUDIYRM0n6uIQPRB4k69Qn1AIGuXOg5XbUCC4vwmKZ6CQEJ3RWkSdZBA8y1ZmGqicUAmIAsvqLZmQJ1e6NyRymJA8YtXGjEDYEA=\",\"dtype\":\"float64\",\"shape\":[19]},\"workload\":[\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\",\"Inference\"]}},\"id\":\"ff8d173d-6065-4602-802e-c4cd1df021b8\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"48673bba-7ca8-48a8-b859-f4090d0e6d68\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"below\":[{\"id\":\"9c834d8f-4afb-45ef-ba56-9318a54fff2f\",\"type\":\"LinearAxis\"}],\"left\":[{\"id\":\"741ac81e-ca48-4d82-8d00-aef4ab8086d6\",\"type\":\"LinearAxis\"}],\"plot_height\":500,\"renderers\":[{\"id\":\"9c834d8f-4afb-45ef-ba56-9318a54fff2f\",\"type\":\"LinearAxis\"},{\"id\":\"93bd3110-db0b-4a87-bb6d-0ab1c24ce2e8\",\"type\":\"Grid\"},{\"id\":\"741ac81e-ca48-4d82-8d00-aef4ab8086d6\",\"type\":\"LinearAxis\"},{\"id\":\"0fdbc3f0-fdde-42d4-902f-9f0b1d8fd642\",\"type\":\"Grid\"},{\"id\":\"cf8a9a24-65b4-43d3-ba2d-1c955b7a0c06\",\"type\":\"Legend\"},{\"id\":\"2bb80635-7c8f-4f41-be95-a6975c0c1489\",\"type\":\"GlyphRenderer\"}],\"title\":{\"id\":\"b2cda517-223a-4526-a1af-9b9865ab3238\",\"type\":\"Title\"},\"toolbar\":{\"id\":\"55749e77-0eb5-47f0-a0f9-fe4fe0b16548\",\"type\":\"Toolbar\"},\"toolbar_location\":null,\"x_range\":{\"id\":\"af96f289-5ed7-4f7f-9f72-578ec54a33f9\",\"type\":\"DataRange1d\"},\"x_scale\":{\"id\":\"21453751-7c25-4644-a7a8-8b22b58885a8\",\"type\":\"LinearScale\"},\"y_range\":{\"id\":\"ca810eb2-baca-40ed-b87e-12d04d649e24\",\"type\":\"DataRange1d\"},\"y_scale\":{\"id\":\"32b2ad24-8de3-41c8-89b5-f3932a10ccbf\",\"type\":\"LinearScale\"}},\"id\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"data_source\":{\"id\":\"ff8d173d-6065-4602-802e-c4cd1df021b8\",\"type\":\"ColumnDataSource\"},\"glyph\":{\"id\":\"e6fa85d6-d654-49d9-bc9e-0b87a7fa4aa6\",\"type\":\"Circle\"},\"hover_glyph\":null,\"muted_glyph\":null,\"nonselection_glyph\":{\"id\":\"376503be-884a-4b68-b317-60cd261824ee\",\"type\":\"Circle\"},\"selection_glyph\":null,\"view\":{\"id\":\"3d5de2dc-ed04-473b-a96b-0e4b0459d5aa\",\"type\":\"CDSView\"}},\"id\":\"2bb80635-7c8f-4f41-be95-a6975c0c1489\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"active_drag\":\"auto\",\"active_inspect\":\"auto\",\"active_scroll\":\"auto\",\"active_tap\":\"auto\",\"tools\":[{\"id\":\"b7bcde55-93a0-440f-ac90-4fb156442e33\",\"type\":\"HoverTool\"}]},\"id\":\"55749e77-0eb5-47f0-a0f9-fe4fe0b16548\",\"type\":\"Toolbar\"},{\"attributes\":{\"items\":[{\"id\":\"16bd8302-2465-49f5-9b6a-f4df91236042\",\"type\":\"LegendItem\"}],\"plot\":{\"id\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\",\"subtype\":\"Figure\",\"type\":\"Plot\"}},\"id\":\"cf8a9a24-65b4-43d3-ba2d-1c955b7a0c06\",\"type\":\"Legend\"},{\"attributes\":{\"plot\":null,\"text\":\"\"},\"id\":\"b2cda517-223a-4526-a1af-9b9865ab3238\",\"type\":\"Title\"},{\"attributes\":{\"callback\":null},\"id\":\"af96f289-5ed7-4f7f-9f72-578ec54a33f9\",\"type\":\"DataRange1d\"},{\"attributes\":{\"source\":{\"id\":\"ff8d173d-6065-4602-802e-c4cd1df021b8\",\"type\":\"ColumnDataSource\"}},\"id\":\"3d5de2dc-ed04-473b-a96b-0e4b0459d5aa\",\"type\":\"CDSView\"},{\"attributes\":{},\"id\":\"c633dd42-40a0-4289-991a-67ae4d94b39f\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"value\":\"#1f77b4\"},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"value\":\"#1f77b4\"},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"throughput\"},\"y\":{\"field\":\"accuracy\"}},\"id\":\"376503be-884a-4b68-b317-60cd261824ee\",\"type\":\"Circle\"},{\"attributes\":{\"callback\":null},\"id\":\"ca810eb2-baca-40ed-b87e-12d04d649e24\",\"type\":\"DataRange1d\"},{\"attributes\":{\"fill_color\":{\"field\":\"model_prefix\",\"transform\":{\"id\":\"a2be6a27-38b8-4164-a1fc-0c810d356780\",\"type\":\"CategoricalColorMapper\"}},\"line_color\":{\"field\":\"model_prefix\",\"transform\":{\"id\":\"a2be6a27-38b8-4164-a1fc-0c810d356780\",\"type\":\"CategoricalColorMapper\"}},\"size\":{\"field\":\"size\",\"units\":\"screen\"},\"x\":{\"field\":\"throughput\"},\"y\":{\"field\":\"accuracy\"}},\"id\":\"e6fa85d6-d654-49d9-bc9e-0b87a7fa4aa6\",\"type\":\"Circle\"},{\"attributes\":{},\"id\":\"21453751-7c25-4644-a7a8-8b22b58885a8\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"32b2ad24-8de3-41c8-89b5-f3932a10ccbf\",\"type\":\"LinearScale\"},{\"attributes\":{\"label\":{\"field\":\"model_prefix\"},\"renderers\":[{\"id\":\"2bb80635-7c8f-4f41-be95-a6975c0c1489\",\"type\":\"GlyphRenderer\"}]},\"id\":\"16bd8302-2465-49f5-9b6a-f4df91236042\",\"type\":\"LegendItem\"},{\"attributes\":{\"plot\":{\"id\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\",\"subtype\":\"Figure\",\"type\":\"Plot\"},\"ticker\":{\"id\":\"fcc6da55-1d26-4cc6-a7e8-6ab76275fcf5\",\"type\":\"BasicTicker\"}},\"id\":\"93bd3110-db0b-4a87-bb6d-0ab1c24ce2e8\",\"type\":\"Grid\"}],\"root_ids\":[\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\"]},\"title\":\"Bokeh Application\",\"version\":\"0.12.13\"}};\n  var render_items = [{\"docid\":\"af289611-c26b-47d5-aa53-50a05210f2e0\",\"elementid\":\"8c89878a-6dca-411c-8cf4-b5d5f95a60a3\",\"modelid\":\"a2f4c192-ef82-405d-b244-d1705f4e1a9d\"}];\n  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n\n  }\n  if (root.Bokeh !== undefined) {\n    embed_document(root);\n  } else {\n    var attempts = 0;\n    var timer = setInterval(function(root) {\n      if (root.Bokeh !== undefined) {\n        embed_document(root);\n        clearInterval(timer);\n      }\n      attempts++;\n      if (attempts > 100) {\n        console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\")\n        clearInterval(timer);\n      }\n    }, 10, root)\n  }\n})(window);",
   "application/vnd.bokehjs_exec.v0+json": ""
  },
  "metadata": {
   "application/vnd.bokehjs_exec.v0+json": {
    "id": "a2f4c192-ef82-405d-b244-d1705f4e1a9d"
   }
  },
  "output_type": "display_data"
 }
]
```
